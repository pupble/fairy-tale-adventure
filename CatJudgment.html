<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI çŒ«çŒ«æ³•åº­ | ç»ˆæå®¡åˆ¤</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FontAwesome å›¾æ ‡ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- å½©å¸¦ç‰¹æ•ˆ -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <!-- Markdown è§£æ -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <!-- å¯çˆ±å­—ä½“ -->
    <link href="https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&family=Noto+Sans+SC:wght@400;700&display=swap" rel="stylesheet">

    <style>
        /* --- åŸºç¡€è®¾å®š --- */
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: #FFF0F5;
            /* åŠ¨æ€èƒŒæ™¯å›¾æ¡ˆ */
            background-image: radial-gradient(#FBCFE8 2px, transparent 2px), radial-gradient(#F472B6 1px, transparent 1px);
            background-size: 40px 40px;
            background-position: 0 0, 20px 20px;
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="%23F472B6"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/><circle cx="12" cy="12" r="5" fill="white"/></svg>') 12 12, auto;
            overflow-x: hidden;
        }

        .cute-font { font-family: 'ZCOOL KuaiLe', cursive; }

        /* --- æ¯›ç»ç’ƒå¡ç‰‡ --- */
        .glass-panel {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            box-shadow: 0 25px 50px -12px rgba(255, 105, 180, 0.25);
            border: 2px solid rgba(255, 255, 255, 0.8);
        }

        /* --- åŠ¨ç”»æ•ˆæœ --- */
        .pop-in { animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes popIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }

        .float-cat { animation: floating 3s ease-in-out infinite; }
        @keyframes floating { 0%, 100% { transform: translateY(0) rotate(0deg); } 50% { transform: translateY(-10px) rotate(2deg); } }

        /* --- ç‚¹å‡»ç‰¹æ•ˆï¼šçŒ«çˆªå° --- */
        .paw-print {
            position: absolute;
            width: 30px;
            height: 30px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Cpath fill='%23F472B6' d='M226.5 92.9c14.3 42.9-.3 86.2-32.6 96.8s-70.1-15.6-84.4-58.5s.3-86.2 32.6-96.8s70.1 15.6 84.4 58.5zM100.4 198.6c18.9 32.4 14.3 70.1-10.2 84.1s-59.1-.9-78-33.3s-14.3-70.1 10.2-84.1s59.1.9 78 33.3zm184.9 4.7c18.9-32.4 53.6-47.3 78-33.3s29.1 51.7 10.2 84.1s-53.6 47.3-78 33.3s-29.1-51.7-10.2-84.1zm-42.1 204.8c47.7-65.4 125.7-88.7 174.2-52.1s43.7 113.3-3.9 178.7s-125.7 88.7-174.2 52.1s-43.7-113.3 3.9-178.7zM362 26.6c14.3-42.9 52.1-53.5 84.4-42.9s46.9 53.9 32.6 96.8s-52.1 53.5-84.4 42.9s-46.9-53.9-32.6-96.8z'/%3E%3C/svg%3E");
            background-size: contain;
            background-repeat: no-repeat;
            pointer-events: none;
            opacity: 0.8;
            transform: translate(-50%, -50%) scale(0.5);
            animation: pawFade 1s forwards;
            z-index: 9999;
        }

        @keyframes pawFade {
            0% { transform: translate(-50%, -50%) scale(0.5) rotate(0deg); opacity: 0.8; }
            50% { opacity: 0.6; }
            100% { transform: translate(-50%, -50%) scale(1.2) rotate(20deg); opacity: 0; }
        }

        /* --- æ»šåŠ¨æ¡éšè— --- */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* --- æ°”æ³¡å¯¹è¯æ¡† --- */
        .bubble {
            position: absolute;
            background: #fff;
            padding: 10px 15px;
            border-radius: 20px;
            border: 2px solid #FBCFE8;
            font-size: 14px;
            color: #DB2777;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
            white-space: nowrap;
            z-index: 10;
        }
        .bubble::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            border-width: 8px 8px 0;
            border-style: solid;
            border-color: #FBCFE8 transparent transparent transparent;
        }
        .show-bubble { opacity: 1; transform: translateY(-10px); }
    </style>
</head>
<!-- æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨ç”¨äºç”ŸæˆçŒ«çˆª -->
<body class="min-h-screen flex items-center justify-center p-4 selection:bg-pink-200 selection:text-pink-900" onclick="createPaw(event)">

    <!-- App ä¸»ç•Œé¢ -->
    <div class="w-full max-w-5xl glass-panel rounded-[2.5rem] relative min-h-[720px] flex flex-col overflow-hidden pop-in transition-all duration-500">
        
        <!-- é¡¶æ  -->
        <header class="bg-gradient-to-r from-pink-50 to-purple-50 p-4 px-8 border-b border-pink-100 flex justify-between items-center z-50">
            <button id="btn-back" onclick="goBack()" class="hidden group flex items-center gap-2 text-gray-500 hover:text-pink-500 transition-colors font-bold text-sm">
                <div class="bg-white p-2 rounded-full shadow-sm group-hover:shadow-md transition">
                    <i class="fa-solid fa-arrow-left"></i>
                </div>
                <span>é‡å®¡</span>
            </button>
            
            <div class="flex flex-col items-center flex-1">
                <h1 class="text-3xl text-pink-500 cute-font tracking-widest drop-shadow-sm flex items-center gap-2">
                    <i class="fa-solid fa-scale-balanced text-2xl"></i>
                    AI çŒ«çŒ«æ³•åº­
                </h1>
                <div class="flex items-center gap-1 text-[10px] text-pink-300 font-bold uppercase tracking-wider">
                    <span class="w-2 h-2 rounded-full bg-green-400 animate-pulse"></span>
                    DeepSeek V3 Live
                </div>
            </div>

            <button onclick="toggleSettings()" class="text-gray-400 hover:text-pink-500 transition-transform hover:rotate-90">
                <i class="fa-solid fa-gear text-xl"></i>
            </button>
        </header>

        <!-- è®¾ç½®é¢æ¿ (æ‚¬æµ®) -->
        <div id="settings-panel" class="hidden absolute top-16 right-6 z-[60] bg-white/95 backdrop-blur-xl p-5 rounded-2xl shadow-2xl border border-pink-200 w-80 transform transition-all origin-top-right">
            <h3 class="text-sm font-bold text-gray-700 mb-3 flex items-center gap-2">
                <i class="fa-solid fa-key text-pink-500"></i> API å¯†é’¥è®¾ç½®
            </h3>
            <div class="relative">
                <input type="password" id="api-key-input" class="w-full bg-gray-50 border border-gray-200 rounded-xl p-3 text-sm mb-3 outline-none focus:ring-2 ring-pink-300 text-gray-600 font-mono" placeholder="sk-...">
            </div>
            <div class="flex justify-between items-center">
                <span class="text-xs text-gray-400">å·²é¢„å¡«æµ‹è¯•Keyï¼Œå¯ç›´æ¥ä½¿ç”¨</span>
                <button onclick="saveSettings()" class="bg-pink-500 hover:bg-pink-600 text-white px-4 py-1.5 rounded-lg text-xs font-bold transition-colors">ä¿å­˜é…ç½®</button>
            </div>
        </div>

        <!-- å†…å®¹åŒºåŸŸ -->
        <main class="flex-1 relative overflow-hidden">
            
            <!-- 1. é¦–é¡µ (ä¿®æ­£å›¾ç‰‡ + äº’åŠ¨) -->
            <div id="view-landing" class="absolute inset-0 flex flex-col items-center justify-center text-center p-8 transition-transform duration-500 ease-in-out">
                
                <!-- çŒ«çŒ«äº’åŠ¨åŒº -->
                <div class="relative group cursor-pointer mb-8" onclick="pokeCat(event)">
                    <!-- æ°”æ³¡ -->
                    <div id="cat-bubble" class="bubble" style="top: -40px; left: 50%; transform: translateX(-50%);">
                        æœ¬å–µä»Šå¤©ä¸æƒ³åŠ ç­...
                    </div>
                    
                    <div class="absolute -inset-6 bg-gradient-to-tr from-pink-200 to-purple-200 rounded-full blur-xl opacity-30 group-hover:opacity-60 transition duration-700 animate-pulse"></div>
                    <!-- ä¿®æ­£åçš„å›¾ç‰‡æºï¼Œä½¿ç”¨æ›´ç¨³å®šçš„ DiceBear v9 -->
                    <img id="cat-img" src="https://api.dicebear.com/9.x/avataaars/svg?seed=Felix&backgroundColor=ffdfbf&clothing=collar&eyes=happy&mouth=smile" 
                         onerror="this.src='https://placekitten.com/200/200'" 
                         alt="Judge Cat" 
                         class="float-cat relative w-52 h-52 drop-shadow-2xl hover:scale-105 transition-transform duration-300 z-10">
                    
                    <div class="absolute -bottom-4 -right-4 bg-white text-pink-600 px-4 py-1.5 rounded-full text-sm font-bold shadow-lg border-2 border-pink-50 rotate-6 z-20">
                        æˆ³æˆ‘æœ‰æƒŠå–œ!
                    </div>
                </div>
                
                <h2 class="text-4xl cute-font text-gray-800 mb-4">ä»Šå¤©è°åˆå—å§”å±ˆäº†ï¼Ÿ</h2>
                <p class="text-gray-500 text-lg mb-10 max-w-lg leading-relaxed">
                    Jimmy å’Œ Linda åˆåµæ¶äº†ï¼Ÿ<br>
                    åˆ«æ€¥ï¼ŒæŠŠ<span class="text-pink-500 font-bold bg-pink-50 px-1 rounded">äº‹å®</span>å’Œ<span class="text-purple-500 font-bold bg-purple-50 px-1 rounded">æƒ…ç»ª</span>éƒ½å‘Šè¯‰æˆ‘ã€‚<br>
                    DeepSeek å¤§è„‘åœ¨çº¿æ–­æ¡ˆï¼Œç»å¯¹ï¼ˆä¸ï¼‰å…¬å¹³ï¼
                </p>

                <button onclick="switchView('view-form')" class="group relative px-10 py-4 bg-gray-900 text-white rounded-2xl font-bold text-xl shadow-xl hover:shadow-2xl hover:-translate-y-1 transition-all overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-r from-pink-500 via-purple-500 to-pink-500 opacity-0 group-hover:opacity-100 transition duration-500 bg-[length:200%_auto] animate-gradient"></div>
                    <span class="relative flex items-center gap-3">
                        <i class="fa-solid fa-gavel text-pink-300 group-hover:text-white transition"></i>
                        æ•²é”¤å¼€åº­
                    </span>
                </button>

                <!-- åº•éƒ¨ææ€ªé“¾æ¥ -->
                <div class="absolute bottom-4 flex gap-4 text-[10px] text-gray-400">
                    <span class="cursor-pointer hover:text-pink-500 hover:underline" onclick="alert('ç¬¬ä¸€æ¡ï¼šçŒ«çŒ«æ°¸è¿œæ˜¯å¯¹çš„ã€‚')">ã€ŠçŒ«çŒ«æ³•åº­åŸºæœ¬æ³•ã€‹</span>
                    <span>â€¢</span>
                    <span class="cursor-pointer hover:text-pink-500 hover:underline" onclick="alert('å»ºè®®ç›´æ¥å–‚ç½å¤´è§£å†³ã€‚')">ã€Šæƒ…ä¾£åµæ¶ç´§æ€¥é¢„æ¡ˆã€‹</span>
                    <span>â€¢</span>
                    <span class="cursor-pointer hover:text-pink-500 hover:underline" onclick="alert('ç³»ç»Ÿæ£€æµ‹åˆ°ä½ ä¹Ÿæƒ³åƒé›¶é£Ÿã€‚')">éšç§æ”¿ç­–</span>
                </div>
            </div>

            <!-- 2. è¡¨å•é¡µ (Jimmy & Linda) -->
            <div id="view-form" class="absolute inset-0 flex flex-col p-6 translate-x-full transition-transform duration-500 ease-in-out bg-white/40 overflow-y-auto no-scrollbar">
                
                <!-- å¿«é€Ÿå¡«å……åŒº -->
                <div class="flex items-center justify-center gap-2 mb-6 overflow-x-auto no-scrollbar py-2">
                    <span class="text-xs font-bold text-gray-400 mr-2 flex-shrink-0">å·æ‡’æ¨¡ç‰ˆ:</span>
                    <button onclick="fillCase('snack')" class="flex-shrink-0 bg-white border border-orange-200 text-orange-500 px-3 py-1.5 rounded-full text-xs font-bold hover:bg-orange-50 transition shadow-sm">ğŸ¿ é›¶é£Ÿæ¡ˆ</button>
                    <button onclick="fillCase('photo')" class="flex-shrink-0 bg-white border border-blue-200 text-blue-500 px-3 py-1.5 rounded-full text-xs font-bold hover:bg-blue-50 transition shadow-sm">ğŸ“¸ æ‹ç…§æ¡ˆ</button>
                    <button onclick="fillCase('msg')" class="flex-shrink-0 bg-white border border-purple-200 text-purple-500 px-3 py-1.5 rounded-full text-xs font-bold hover:bg-purple-50 transition shadow-sm">ğŸ“± å›ä¿¡æ…¢</button>
                </div>

                <div class="flex flex-col md:flex-row gap-5 pb-24">
                    <!-- ç”·æ–¹ -->
                    <div class="flex-1 bg-white p-5 rounded-3xl shadow-sm border-2 border-transparent hover:border-blue-100 transition-all group">
                        <div class="flex items-center gap-3 mb-4 pb-2 border-b border-gray-100">
                            <div class="w-10 h-10 rounded-xl bg-blue-100 text-blue-500 flex items-center justify-center text-xl group-hover:scale-110 transition">ğŸ‘¦</div>
                            <input id="name-male" type="text" value="Jimmy" class="font-bold text-gray-700 text-lg w-full outline-none bg-transparent placeholder-gray-300" placeholder="ç”·ç”Ÿåå­—">
                        </div>
                        <div class="space-y-3">
                            <div>
                                <label class="text-xs font-bold text-blue-400 uppercase ml-1">äº‹å® (Fact)</label>
                                <textarea id="fact-male" class="w-full h-20 p-3 mt-1 bg-blue-50/30 rounded-xl text-sm text-gray-600 outline-none focus:bg-blue-50 transition resize-none border border-transparent focus:border-blue-200" placeholder="å‘ç”Ÿäº†ä»€ä¹ˆ..."></textarea>
                            </div>
                            <div>
                                <label class="text-xs font-bold text-blue-400 uppercase ml-1">å§”å±ˆ (Feeling)</label>
                                <textarea id="feel-male" class="w-full h-20 p-3 mt-1 bg-blue-50/30 rounded-xl text-sm text-gray-600 outline-none focus:bg-blue-50 transition resize-none border border-transparent focus:border-blue-200" placeholder="å¿ƒé‡Œæ€ä¹ˆæƒ³çš„..."></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- å¥³æ–¹ -->
                    <div class="flex-1 bg-white p-5 rounded-3xl shadow-sm border-2 border-transparent hover:border-pink-100 transition-all group">
                        <div class="flex items-center gap-3 mb-4 pb-2 border-b border-gray-100">
                            <div class="w-10 h-10 rounded-xl bg-pink-100 text-pink-500 flex items-center justify-center text-xl group-hover:scale-110 transition">ğŸ‘§</div>
                            <input id="name-female" type="text" value="Linda" class="font-bold text-gray-700 text-lg w-full outline-none bg-transparent placeholder-gray-300" placeholder="å¥³ç”Ÿåå­—">
                        </div>
                        <div class="space-y-3">
                            <div>
                                <label class="text-xs font-bold text-pink-400 uppercase ml-1">äº‹å® (Fact)</label>
                                <textarea id="fact-female" class="w-full h-20 p-3 mt-1 bg-pink-50/30 rounded-xl text-sm text-gray-600 outline-none focus:bg-pink-50 transition resize-none border border-transparent focus:border-pink-200" placeholder="å‘ç”Ÿäº†ä»€ä¹ˆ..."></textarea>
                            </div>
                            <div>
                                <label class="text-xs font-bold text-pink-400 uppercase ml-1">å§”å±ˆ (Feeling)</label>
                                <textarea id="feel-female" class="w-full h-20 p-3 mt-1 bg-pink-50/30 rounded-xl text-sm text-gray-600 outline-none focus:bg-pink-50 transition resize-none border border-transparent focus:border-pink-200" placeholder="å¿ƒé‡Œæ€ä¹ˆæƒ³çš„..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- æäº¤æŒ‰é’® -->
                <div class="absolute bottom-6 left-0 right-0 flex justify-center z-20 pointer-events-none">
                    <button onclick="submitToAI(event)" class="pointer-events-auto px-10 py-3 bg-gray-900 text-white rounded-full font-bold shadow-lg hover:bg-black hover:scale-105 transition-all flex items-center gap-2 group">
                        <span>æäº¤å®¡åˆ¤</span>
                        <i class="fa-solid fa-paper-plane text-pink-400 group-hover:translate-x-1 transition-transform"></i>
                    </button>
                </div>
            </div>

            <!-- 3. Loading (çŒ«çŒ«æ€è€ƒ) -->
            <div id="view-loading" class="hidden absolute inset-0 flex flex-col items-center justify-center bg-white/90 z-50 backdrop-blur-sm">
                <div class="relative w-32 h-32 mb-6">
                    <div class="absolute inset-0 rounded-full border-4 border-gray-100"></div>
                    <div class="absolute inset-0 rounded-full border-4 border-pink-500 border-t-transparent animate-spin"></div>
                    <img src="https://api.dicebear.com/9.x/avataaars/svg?seed=Felix&backgroundColor=transparent&clothing=collar&eyes=happy&mouth=smile" class="absolute inset-0 p-4 animate-pulse">
                </div>
                <h3 class="text-2xl cute-font text-gray-800 mb-2">æ­£åœ¨è¿æ¥å–µæ˜Ÿäº‘ç«¯...</h3>
                <div id="ai-log" class="text-xs font-mono text-pink-400 h-6 overflow-hidden">> DeepSeek æ­£åœ¨é˜…è¯»ä¾›è¯...</div>
            </div>

            <!-- 4. åˆ¤å†³ç»“æœé¡µ -->
            <div id="view-result" class="absolute inset-0 flex flex-col p-6 translate-x-full transition-transform duration-500 bg-white/50 overflow-y-auto no-scrollbar">
                
                <!-- ç»“æœå¤´éƒ¨ -->
                <div class="text-center mb-6 relative">
                    <div class="inline-block bg-gradient-to-r from-red-500 to-pink-500 text-white px-4 py-1 rounded-full text-xs font-bold uppercase tracking-widest shadow-md transform -rotate-2">
                        Verdict Reached
                    </div>
                    <h2 id="result-title" class="text-3xl cute-font text-gray-800 mt-3 drop-shadow-sm">æ¡ˆä»¶æ ‡é¢˜ç”Ÿæˆä¸­...</h2>
                </div>

                <!-- è´£ä»» PK æ¡ -->
                <div class="bg-white p-5 rounded-[2rem] shadow-sm border border-white mb-6">
                    <div class="flex justify-between text-xs font-bold text-gray-400 mb-2 uppercase px-2">
                        <span id="label-male">Jimmy</span>
                        <span id="label-female">Linda</span>
                    </div>
                    <div class="relative h-12 w-full bg-gray-100 rounded-full overflow-hidden flex font-bold text-white text-lg shadow-inner">
                        <div id="bar-male" class="bg-blue-400 flex items-center justify-center transition-all duration-1000 w-1/2 relative overflow-hidden">
                            <span class="relative z-10">50%</span>
                            <div class="absolute inset-0 bg-white/20 -skew-x-12 translate-x-full animate-[shimmer_2s_infinite]"></div>
                        </div>
                        <div id="bar-female" class="bg-pink-400 flex items-center justify-center transition-all duration-1000 w-1/2 relative overflow-hidden">
                            <span class="relative z-10">50%</span>
                            <div class="absolute inset-0 bg-white/20 -skew-x-12 translate-x-full animate-[shimmer_2s_infinite]"></div>
                        </div>
                        <!-- ä¸­é—´ VS å¾½ç«  -->
                        <div class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-white rounded-full w-12 h-12 flex items-center justify-center text-yellow-500 shadow-md border-4 border-gray-50 z-10">
                            <i class="fa-solid fa-gavel text-xl"></i>
                        </div>
                    </div>
                </div>

                <!-- ç»“æœå†…å®¹å¡ç‰‡ -->
                <div class="space-y-4 pb-24">
                    <!-- åˆ†æ -->
                    <div class="bg-white/80 p-5 rounded-2xl border border-pink-50 shadow-sm relative overflow-hidden">
                        <div class="absolute top-0 left-0 w-1 h-full bg-pink-400"></div>
                        <h3 class="text-pink-600 font-bold mb-3 flex items-center gap-2">
                            <i class="fa-solid fa-glasses"></i> å–µæ˜Ÿäººé”è¯„
                        </h3>
                        <div id="result-analysis" class="text-sm text-gray-600 leading-7 text-justify markdown-body"></div>
                    </div>

                    <!-- ä»»åŠ¡ -->
                    <div class="bg-yellow-50 p-5 rounded-2xl border border-yellow-100 shadow-sm">
                        <h3 class="text-yellow-700 font-bold mb-3 flex items-center gap-2">
                            <i class="fa-solid fa-list-check"></i> å¼ºåˆ¶æ‰§è¡Œæ¸…å•
                        </h3>
                        <div id="result-tasks" class="space-y-3"></div>
                    </div>
                </div>

                <!-- åº•éƒ¨æ“ä½œ -->
                <div class="absolute bottom-6 left-0 right-0 flex justify-center z-20 pointer-events-none">
                    <button onclick="switchView('view-restore')" class="pointer-events-auto px-8 py-3 bg-gradient-to-r from-pink-500 to-rose-500 text-white rounded-full font-bold shadow-lg hover:shadow-pink-300/50 hover:-translate-y-1 transition-all animate-bounce">
                        æ¥å—åˆ¤å†³ & å’Œå¥½ <i class="fa-solid fa-heart ml-1"></i>
                    </button>
                </div>
            </div>

            <!-- 5. ä¿®å¤å…³ç³»é¡µ -->
            <div id="view-restore" class="absolute inset-0 flex flex-col items-center justify-center p-6 translate-x-full transition-transform duration-500 bg-white/90">
                <h2 class="text-3xl cute-font text-gray-800 mb-2">ğŸ’– å…³ç³»ä¿®å¤ä»ª</h2>
                <p class="text-gray-400 text-sm mb-8">åˆ«æ€„æ°”å•¦ï¼Œç»™ä¸ªå°é˜¶ä¸‹å§ï¼</p>

                <!-- æ¸©åº¦è®¡ -->
                <div class="relative w-28 h-64 bg-gray-100 rounded-full border-4 border-white shadow-[inset_0_2px_4px_rgba(0,0,0,0.1)] flex flex-col justify-end overflow-hidden mb-6">
                    <div id="liquid" class="w-full bg-blue-400 transition-all duration-700 relative flex items-start justify-center pt-2" style="height: 30%">
                        <div class="w-full h-full opacity-30 bg-[url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4IiBoZWlnaHQ9IjgiPgo8cmVjdCB3aWR0aD0iOCIgaGVpZ2h0PSI4IiBmaWxsPSIjZmZmIiBmaWxsLW9wYWNpdHk9IjAuMiIvPjwvc3ZnPg==')]"></div>
                    </div>
                    <!-- åˆ»åº¦çº¿ -->
                    <div class="absolute top-1/4 w-full h-px bg-gray-300 left-0"></div>
                    <div class="absolute top-2/4 w-full h-px bg-gray-300 left-0"></div>
                    <div class="absolute top-3/4 w-full h-px bg-gray-300 left-0"></div>
                </div>

                <div id="temp-val" class="text-5xl font-black text-blue-400 cute-font mb-8 transition-colors">30Â°C</div>

                <div class="grid grid-cols-2 gap-3 w-full max-w-sm">
                    <button onclick="addHeat(20)" class="bg-white border-2 border-pink-50 hover:border-pink-300 p-3 rounded-xl text-sm font-bold text-gray-600 hover:bg-pink-50 transition active:scale-95">
                        ğŸ¥¤ è¯·å–å¥¶èŒ¶
                    </button>
                    <button onclick="addHeat(30)" class="bg-white border-2 border-pink-50 hover:border-pink-300 p-3 rounded-xl text-sm font-bold text-gray-600 hover:bg-pink-50 transition active:scale-95">
                        ğŸ¤ æ¡æ‰‹è¨€å’Œ
                    </button>
                    <button onclick="addHeat(40)" class="col-span-2 bg-gradient-to-r from-pink-100 to-purple-100 border-2 border-white hover:shadow-md p-3 rounded-xl text-sm font-bold text-pink-600 transition active:scale-95">
                        ğŸ˜˜ äº²äº²æŠ±æŠ±ä¸¾é«˜é«˜ (å¤§æ‹›)
                    </button>
                </div>

                <button onclick="resetApp()" class="mt-10 text-gray-400 hover:text-pink-500 text-xs underline decoration-dotted">
                    å†åˆ¤ä¸€ä¸ªæ–°æ¡ˆå­
                </button>
            </div>

        </main>
    </div>

    <!-- é€»è¾‘ä»£ç  -->
    <script>
        // --- æ ¸å¿ƒé…ç½® ---
        // æ³¨æ„ï¼šè¿™æ˜¯ä¸ºäº†æ¼”ç¤ºï¼Œå®é™…é¡¹ç›®è¯·å‹¿å°† Key æš´éœ²
        let DEEPSEEK_API_KEY = "sk-9bc8bb993b684218803e58cdeac07d12"; 
        const API_URL = "https://api.deepseek.com/chat/completions";

        // --- 1. ç‚¹å‡»ç‰¹æ•ˆ (çŒ«çˆª) ---
        function createPaw(e) {
            // å¦‚æœç‚¹å‡»çš„æ˜¯æŒ‰é’®æˆ–è¾“å…¥æ¡†ï¼Œä¸ç”ŸæˆçŒ«çˆªï¼Œé¿å…é®æŒ¡
            if (e.target.tagName === 'BUTTON' || e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;

            const paw = document.createElement('div');
            paw.classList.add('paw-print');
            paw.style.left = e.clientX + 'px';
            paw.style.top = e.clientY + 'px';
            
            // éšæœºæ—‹è½¬ä¸€ç‚¹è§’åº¦
            const randomRot = Math.random() * 40 - 20; 
            paw.style.transform = `translate(-50%, -50%) scale(0.5) rotate(${randomRot}deg)`;

            document.body.appendChild(paw);

            // åŠ¨ç”»ç»“æŸåç§»é™¤
            setTimeout(() => {
                paw.remove();
            }, 1000);
        }

        // --- 2. æˆ³çŒ«çŒ«äº’åŠ¨ ---
        const catQuotes = [
            "åˆ«æˆ³äº†ï¼Œå†æˆ³è¦æ”¶è´¹äº†ï¼ğŸŸ",
            "æœ¬å®˜æ­£åœ¨åˆä¼‘ï¼Œæœ‰äº‹èµ·å¥ã€‚",
            "ä½ è¿™ä¸ªæ¡ˆå­ï¼Œå¾ˆéš¾è¯„...",
            "å†æˆ³æˆ‘å°±åˆ¤ä½ è¾“å“¦ï¼",
            "è®°å¾—ç»™æˆ‘å¸¦å°é±¼å¹²~"
        ];
        function pokeCat(e) {
            e.stopPropagation(); // é˜²æ­¢è§¦å‘å…¨å±€çŒ«çˆª
            const bubble = document.getElementById('cat-bubble');
            const img = document.getElementById('cat-img');
            
            // éšæœºè¯­å½•
            bubble.innerText = catQuotes[Math.floor(Math.random() * catQuotes.length)];
            
            // åŠ¨ç”»
            bubble.classList.add('show-bubble');
            img.style.transform = "scale(0.9) rotate(-5deg)";
            
            setTimeout(() => {
                bubble.classList.remove('show-bubble');
                img.style.transform = ""; // å¤åŸ
            }, 2000);
        }

        // --- 3. è§†å›¾å¯¼èˆª ---
        function switchView(viewId) {
            const views = ['view-landing', 'view-form', 'view-result', 'view-restore'];
            const elements = views.map(id => document.getElementById(id));
            const btnBack = document.getElementById('btn-back');

            elements.forEach(el => {
                if (el.id === viewId) {
                    el.style.transform = 'translateX(0)';
                } else {
                    // ç®€å•çš„é€»è¾‘ï¼šå¦‚æœç›®æ ‡åœ¨å½“å‰è§†å›¾åºåˆ—ä¹‹åï¼Œå½“å‰å¾€å·¦ç§»ï¼Œåä¹‹å¾€å³
                    // è¿™é‡Œä¸ºäº†ç®€å•ï¼Œé™¤äº† landingï¼Œå…¶ä»–é»˜è®¤åœ¨å³ä¾§ï¼Œæ˜¾ç¤ºæ—¶ç§»å…¥
                    el.style.transform = 'translateX(100%)';
                }
            });

            // ç‰¹æ®Šå¤„ç† landing
            if (viewId === 'view-landing') {
                document.getElementById('view-form').style.transform = 'translateX(100%)';
                document.getElementById('view-result').style.transform = 'translateX(100%)';
                document.getElementById('view-restore').style.transform = 'translateX(100%)';
                btnBack.classList.add('hidden');
            } else {
                document.getElementById('view-landing').style.transform = 'translateX(-100%)';
                if(viewId !== 'view-restore') btnBack.classList.remove('hidden');
            }
        }

        function goBack() { switchView('view-landing'); }

        // --- 4. é¢„è®¾å¡«å…… ---
        const presets = {
            snack: { j_f: "æˆ‘ä¹°äº†ä¸€åŒ…è–¯ç‰‡ï¼Œçœ‹çƒèµ›æ—¶ä¸çŸ¥ä¸è§‰åƒå®Œäº†ã€‚", j_e: "æˆ‘å½“æ—¶å¤ªæŠ•å…¥äº†ï¼Œè€Œä¸”å¹³æ—¶æˆ‘ä¹Ÿç»™å¥¹ä¹°é›¶é£Ÿå•Šï¼Œè‡³äºå› ä¸ºä¸€åŒ…è–¯ç‰‡ç”Ÿæ°”å—ï¼Ÿ", l_f: "ä»–åƒç‹¬é£Ÿï¼Œé—®éƒ½æ²¡é—®æˆ‘ä¸€å¥ï¼ŒåŒ…è£…è¢‹ç›´æ¥æ‰”åƒåœ¾æ¡¶ã€‚", l_e: "ä¸æ˜¯æƒ³åƒè–¯ç‰‡ï¼Œæ˜¯è§‰å¾—ä»–å¿ƒé‡Œæ ¹æœ¬æ²¡æœ‰æˆ‘ï¼Œè¿™ç§è‡ªç§çš„è¡Œä¸ºè®©æˆ‘å¾ˆå¯’å¿ƒã€‚" },
            photo: { j_f: "å»å…¬å›­ç©ï¼Œæˆ‘ç»™å¥¹æ‹äº†äº”åå¤šå¼ ç…§ç‰‡ï¼Œå¥¹ä¸€å¼ éƒ½ä¸æ»¡æ„ã€‚", j_e: "æˆ‘è§‰å¾—å…‰çº¿æ„å›¾éƒ½æŒºå¥½çš„ï¼ŒçœŸå®çš„å¥¹å°±å¾ˆç¾å•Šï¼Œéè¦ä¿®æˆç½‘çº¢è„¸ã€‚", l_f: "æŠŠæˆ‘æ‹å¾—åˆçŸ®åˆèƒ–ï¼Œå…¨æ˜¯åŒä¸‹å·´å’Œé—­çœ¼ç…§ã€‚", l_e: "è®©ä»–å­¦ä¸€ä¸‹æ„å›¾å¾ˆéš¾å—ï¼Ÿæ•·è¡äº†äº‹ï¼Œæ ¹æœ¬ä¸é‡è§†æˆ‘ä»¬çš„çº¦ä¼šå›å¿†ã€‚" },
            msg: { j_f: "æ‰“ç‹è€…è£è€€æ™‹çº§èµ›ï¼Œæ²¡åˆ‡å‡ºå»å›æ¶ˆæ¯ã€‚", j_e: "å›¢æˆ˜å…³é”®æ—¶åˆ»æ€ä¹ˆå›ï¼Ÿæˆ‘å°±æ™šå›äº†15åˆ†é’Ÿè€Œå·²ã€‚", l_f: "å‘æ¶ˆæ¯ä¸¤ä¸ªå°æ—¶ä¸å›ï¼Œç»“æœçœ‹ä»–åœ¨å‘æœ‹å‹åœˆç‚¹èµã€‚", l_e: "æœ‰æ—¶é—´ç‚¹èµæ²¡æ—¶é—´å›æˆ‘ï¼Ÿè¿™å°±æ˜¯å†·æš´åŠ›ï¼" }
        };
        function fillCase(type) {
            const d = presets[type];
            document.getElementById('fact-male').value = d.j_f;
            document.getElementById('feel-male').value = d.j_e;
            document.getElementById('fact-female').value = d.l_f;
            document.getElementById('feel-female').value = d.l_e;
        }

        // --- 5. AI æäº¤é€»è¾‘ ---
        async function submitToAI(e) {
            e.stopPropagation();
            const nm = document.getElementById('name-male').value || "Jimmy";
            const nf = document.getElementById('name-female').value || "Linda";
            const fm = document.getElementById('fact-male').value;
            const em = document.getElementById('feel-male').value;
            const ff = document.getElementById('fact-female').value;
            const ef = document.getElementById('feel-female').value;

            if ((!fm && !em) || (!ff && !ef)) {
                alert("è¯·è‡³å°‘è¾“å…¥ä¸€äº›å†…å®¹ï¼ŒçŒ«çŒ«æ— æ³•å®¡åˆ¤ç©ºæ°”ï¼ğŸ±");
                return;
            }

            // Show Loading
            document.getElementById('view-loading').classList.remove('hidden');
            const log = document.getElementById('ai-log');

            const prompt = `ä½ æ˜¯ä¸€åªâ€œçŒ«çŒ«å¤§æ³•å®˜â€ï¼Œæ€§æ ¼å¹½é»˜ã€æ¯’èˆŒä½†å…¬æ­£ã€‚è¯·åˆ†ææƒ…ä¾£åµæ¶ï¼š
            ç”·æ–¹(${nm}): äº‹å®[${fm}], å§”å±ˆ[${em}]ã€‚
            å¥³æ–¹(${nf}): äº‹å®[${ff}], å§”å±ˆ[${ef}]ã€‚
            
            è¯·è¿”å›çº¯JSONï¼Œä¸è¦Markdownæ ¼å¼ï¼ŒåŒ…å«ï¼š
            title (å¥½ç¬‘çš„æ ‡é¢˜),
            score_male (ç”·æ–¹è´£ä»»0-100),
            score_female (å¥³æ–¹è´£ä»»,åˆè®¡100),
            analysis (å¹½é»˜æ·±åˆ»çš„åˆ†æ,300å­—å†…),
            tasks (3ä¸ªå…·ä½“çš„å’Œè§£ä»»åŠ¡æ•°ç»„)ã€‚`;

            try {
                log.innerText = "> æ­£åœ¨åŠ å¯†ä¼ è¾“è‡³ DeepSeek...";
                const res = await fetch(API_URL, {
                    method: "POST",
                    headers: { "Content-Type": "application/json", "Authorization": `Bearer ${DEEPSEEK_API_KEY}` },
                    body: JSON.stringify({
                        model: "deepseek-chat",
                        messages: [{role: "system", content: "You are a helpful assistant outputting JSON."}, {role: "user", content: prompt}],
                        stream: false
                    })
                });

                if (!res.ok) throw new Error("APIè¿æ¥å¤±è´¥");
                const data = await res.json();
                let content = data.choices[0].message.content.replace(/```json/g, "").replace(/```/g, "").trim();
                const json = JSON.parse(content);
                renderResult(json, nm, nf);

            } catch (err) {
                console.error(err);
                log.innerText = "> ç½‘ç»œæ³¢åŠ¨ï¼Œå¯ç”¨æœ¬åœ°çŒ«ç²®...";
                setTimeout(() => useOffline(nm, nf), 1500);
            }
        }

        function renderResult(data, nm, nf) {
            document.getElementById('view-loading').classList.add('hidden');
            document.getElementById('result-title').innerText = data.title;
            document.getElementById('label-male').innerText = nm;
            document.getElementById('label-female').innerText = nf;
            
            // è¿›åº¦æ¡åŠ¨ç”»
            setTimeout(() => {
                document.getElementById('bar-male').style.width = data.score_male + "%";
                document.getElementById('bar-male').querySelector('span').innerText = data.score_male + "%";
                document.getElementById('bar-female').style.width = data.score_female + "%";
                document.getElementById('bar-female').querySelector('span').innerText = data.score_female + "%";
            }, 100);

            document.getElementById('result-analysis').innerHTML = marked.parse(data.analysis);
            
            const taskHtml = data.tasks.map((t, i) => `
                <div class="flex items-start gap-3 bg-white p-3 rounded-xl border border-yellow-100">
                    <span class="bg-yellow-400 text-white w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold shrink-0 mt-0.5">${i+1}</span>
                    <span class="text-sm text-gray-600">${t}</span>
                </div>`).join('');
            document.getElementById('result-tasks').innerHTML = taskHtml;
            
            switchView('view-result');
        }

        function useOffline(nm, nf) {
            renderResult({
                title: "ä¿¡å·ä¸¢å¤±çš„ç½—ç”Ÿé—¨",
                score_male: 50, score_female: 50,
                analysis: "è™½ç„¶æœ¬å–µä¸ DeepSeek æ¯æ˜Ÿå¤±è”ï¼Œä½†æ ¹æ®ç»éªŒï¼šå…¬è¯´å…¬æœ‰ç†ï¼Œå©†è¯´å©†æœ‰ç†ã€‚ç”·æ–¹è§‰å¾—æ˜¯å°äº‹ï¼Œå¥³æ–¹è§‰å¾—æ˜¯æ€åº¦ã€‚è¿™ç§æ—¶å€™ï¼Œè°å…ˆä½å¤´è°å°±èµ¢äº†ï¼ˆæŒ‡èµ¢å¾—å¯¹æ–¹çš„å¿ƒï¼‰ã€‚",
                tasks: [`${nm} ç«‹åˆ»ç»™ ${nf} å‘ä¸€ä¸ªçº¢åŒ…ã€‚`, "ä¸¤äººå¯¹è§†10ç§’ä¸å‡†ç¬‘ã€‚", "ä¸€èµ·ç‚¹ä»½å¤–å–åƒã€‚"]
            }, nm, nf);
        }

        // --- 6. æ¸©åº¦è®¡ä¸å½©å¸¦ ---
        let heat = 30;
        function addHeat(val) {
            heat = Math.min(100, heat + val);
            const l = document.getElementById('liquid');
            const t = document.getElementById('temp-val');
            
            l.style.height = heat + "%";
            t.innerText = heat + "Â°C";

            if (heat < 60) {
                l.className = "w-full bg-blue-400 transition-all duration-700 relative pt-2 flex justify-center";
                t.className = "text-5xl font-black text-blue-400 cute-font mb-8 transition-colors";
            } else if (heat < 90) {
                l.className = "w-full bg-pink-400 transition-all duration-700 relative pt-2 flex justify-center";
                t.className = "text-5xl font-black text-pink-400 cute-font mb-8 transition-colors";
            } else {
                l.className = "w-full bg-red-500 transition-all duration-700 relative pt-2 flex justify-center";
                t.className = "text-5xl font-black text-red-500 cute-font mb-8 transition-colors animate-bounce";
                confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 }, colors: ['#F472B6', '#FBBF24'] });
            }
        }

        function resetApp() {
            heat = 30;
            document.getElementById('liquid').style.height = "30%";
            document.getElementById('liquid').className = "w-full bg-blue-400 transition-all duration-700 relative pt-2 flex justify-center";
            document.getElementById('temp-val').innerText = "30Â°C";
            document.getElementById('temp-val').className = "text-5xl font-black text-blue-400 cute-font mb-8 transition-colors";
            
            document.getElementById('name-male').value = "Jimmy";
            document.getElementById('name-female').value = "Linda";
            document.getElementById('fact-male').value = "";
            document.getElementById('feel-male').value = "";
            document.getElementById('fact-female').value = "";
            document.getElementById('feel-female').value = "";
            
            switchView('view-landing');
        }

        // --- è®¾ç½® ---
        function toggleSettings() { 
            document.getElementById('settings-panel').classList.toggle('hidden'); 
            document.getElementById('api-key-input').value = DEEPSEEK_API_KEY;
        }
        function saveSettings() {
            const v = document.getElementById('api-key-input').value;
            if(v) { DEEPSEEK_API_KEY = v; alert('é…ç½®å·²ä¿å­˜'); toggleSettings(); }
        }
    </script>
</body>
</html>
